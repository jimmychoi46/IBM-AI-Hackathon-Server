# ğŸš€ Watsonx ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´íŠ¸ ì—°ë™ í”„ë¡œì íŠ¸ (Backend)

ì´ íŒŒì¼ì€ ë°±ì—”ë“œ ì„œë²„ì˜ ì„¤ì •, ì‹¤í–‰ ë° í”„ë¡ íŠ¸ì—”ë“œ í˜‘ì—…ì„ ìœ„í•œ í†µí•© ê°€ì´ë“œì…ë‹ˆë‹¤. (ì„œë²„ êµ¬ë™ë¶€í„° API ì—°ë™ê¹Œì§€ ê³¼ì • í™•ì¸ ê°€ëŠ¥)

---

## 1. í™˜ê²½ êµ¬ì¶• ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

í”„ë¡œì íŠ¸ êµ¬ë™ì„ ìœ„í•´ì„œëŠ” íŒŒì´ì¬(Python) í™˜ê²½ì—ì„œ ì•„ë˜ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

```bash
# í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì„¤ì¹˜ (ë²„ì „ ê³ ì •)
pip install fastapi==0.115.6 uvicorn==0.34.0 httpx==0.28.1 python-dotenv==1.0.1
```

## 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env)

í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— .env íŒŒì¼ì„ ìƒì„±í•˜ê³ , ì•„ë˜ í•­ëª©ì— ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.

â€» í•´ë‹¹ ë¶€ë¶„ì€ í•´ë‹¹ ì—ì´ì „íŠ¸ë¥¼ êµ¬ì¶•í•œ ë‹´ë‹¹ìì˜ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì‹œê¸¸ ë°”ëë‹ˆë‹¤.


### IBM Cloud ì¸ì¦ ë° ì¸ìŠ¤í„´ìŠ¤ ì •ë³´

IBM_API_KEY=your_actual_api_key_here

INSTANCE_ID=your_actual_instance_id_here

### ì„œë¹„ìŠ¤ ë¦¬ì „ (ê¸°ë³¸ê°’: us-south)
REGION=us-south

### Watsonx ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´íŠ¸ ì—ì´ì „íŠ¸ ì •ë³´ (Supervisor Agentì˜ Agent ID ì‚¬ìš© ê¶Œì¥)
AGENT_ID=your_actual_agent_id_here


## 3. ì„œë²„ ì‹¤í–‰ ë°©ë²•

ì„œë²„ ë©”ì¸ íŒŒì¼ëª…ì´ server.pyì¸ ê²½ìš°, ì•„ë˜ ëª…ë ¹ì–´ë¡œ ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.

```python
python server.py
```

Base URL: http://localhost:8000

ëŒ€í™”í˜• API ë¬¸ì„œ (Swagger): http://localhost:8000/docs

â†’ ì—¬ê¸°ì„œ ì§ì ‘ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

## 4. í”„ë¡ íŠ¸ì—”ë“œ API ì—°ë™ ëª…ì„¸ (API Guide)

[POST] /api/chat

ì‚¬ìš©ìì˜ ì§ˆë¬¸ì„ ë°±ì—”ë“œë¥¼ ê±°ì³ Watsonx ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´íŠ¸ì— ì „ë‹¬, ì‘ë‹µì„ ë°›ì•„ì˜µë‹ˆë‹¤.

### Request Body (JSON)

1) JSON í•„ìˆ˜ í•„ë“œ (JSON ìš”ì²­ì„ ìœ„í•¨)

   - user_query (String): ì±—ë´‡ì—ê²Œ ì „ë‹¬í•  ì‚¬ìš©ì ì§ˆë¬¸ ë©”ì‹œì§€

2) JSON ìš”ì²­ ì˜ˆì‹œ

```json
   {
     "user_query": "ì„œìš¸ ì‹œì²­ ìœ„ì¹˜ì™€ ê·¼ì²˜ ë§›ì§‘ ì•Œë ¤ì¤˜"
   }
```
### Response Body (JSON)

1) JSON ë°˜í™˜ í•„ë“œ

   - status (String): ì„±ê³µ ì—¬ë¶€ ("success")

   - answer (String): ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì¤„ ì±—ë´‡ì˜ ìµœì¢… ë‹µë³€ í…ìŠ¤íŠ¸

   - data (Object): Watsonx ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´íŠ¸ ì›ë³¸ ë°ì´í„°

2) JSON ì‘ë‹µ ì˜ˆì‹œ


```json
   {
     "status": "success",
     "answer": "ì„œìš¸ ì‹œì²­ì€ ì¤‘êµ¬ì— ìœ„ì¹˜í•´ ìˆìœ¼ë©°...",
     "data": {
       "results": [
         {
           "data": {
             "output": "ì„œìš¸ ì‹œì²­ì€ ì¤‘êµ¬ì— ìœ„ì¹˜í•´ ìˆìœ¼ë©°...",
             "skill_result": { "lat": 37.5665, "lng": 126.9780 }
           }
         }
       ]
     }
   }
```

## 5.ìƒì„¸ ì˜ˆì™¸ ì²˜ë¦¬ ê°€ì´ë“œ

í†µì‹  ì¤‘ ì—ëŸ¬ ë°œìƒ ì‹œ HTTP ìƒíƒœ ì½”ë“œì™€ í•¨ê»˜ ì•„ë˜ì™€ ê°™ì€ ìƒì„¸ ë©”ì‹œì§€ê°€ ë°˜í™˜ë©ë‹ˆë‹¤.

- 401 Unauthorized: ì¸ì¦ ì˜¤ë¥˜ -> IBM API Key ì„¤ì • í™•ì¸ í•„ìš”.

- 503 Service Unavailable: ì—°ê²° ì˜¤ë¥˜(IBM Cloud ì„œë²„ ì ‘ì† ë¶ˆê°€) -> ë„¤íŠ¸ì›Œí¬ í™•ì¸ í•„ìš”.

- 504 Gateway Timeout: ì‹œê°„ ì´ˆê³¼(Watsonx ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´íŠ¸ ì‘ë‹µ ì§€ì—° (ì„¤ì • ì‹œê°„:ì´ 60ì´ˆ[ì ‘ì† 10ì´ˆ + ë°ì´í„° ì „ì†¡ 50ì´ˆ]))
- 
  -> ì ì‹œ í›„ ì¬ì‹œë„ ê¶Œì¥.

- 500 Internal Server Error: Unexpected Error(ë°±ì—”ë“œ ë‚´ë¶€ ë¡œì§ ì˜¤ë¥˜ ë°œìƒ)



---
